### 命令用 ! 开始一个历史展开

* 假设当前bash已经有如下的历史：

```bash
history
echo 1 2 3 4 5
ls 6 7 8 9 10
echo 11 12 13 14 15
cat 16 17 18 19 20
echo 21 22 23 24 25

```

```bash
!n                # 表示第n条命令，如!2表示执行ls 6 7 8 9 10
!-n               # 表示倒数第n条命令，如!-3表示执行echo 11 12 13 14 15
!!                # 表示上一条命令，是!-1的快捷方式
!string           # 表示以string开始的最近的一条命令，如!echo表示echo 21 22 23 24 25
!?string?         # 表示含有string的最近的一条命令，如!?6?表示cat 16 17 18 19 20
^string1^string2^ # 表示执行上一条命令，并将其中的第一个string1替换为string2，如果string1不存在则替换失败，不会执行命令。
!#                # 表示当前命令现在已经输入的部分，如echo 1 2 !#会执行echo 1 2 echo 1 2


!!:0              # 表示上一命令的第0个参数，即命令本身，得到的是echo
!2:n              # 表示第2个命令的第n个参数，如!2:2得到的是7
!!:^              # 表示上一命令第1个参数，可进一步简写为!^，与!!:1同义，得到的是21
!!:$              # 表示上一命令的最后一个参数，可进一步简写为!$，得到的是25
!!:x-y            # 表示第x到第y个参数，-y意为0-y，如!-2:3-4得到的是18 19
!!:*              # 表示上一命令的参数部分，可进一步简写为!*，如!!:*得到的是21 22 23 24 25
!!:n*             # 跟!!:n-$同义
!!:n-             # 意为!!:n-$-1，从第n个参数到倒数第二个参数，如!-2:3-得到的是18 19```
```

* 通过bash历史展开实现创建并cd到目录的方式为

```bash
mkdir somewhere/dir && cd !#:1          # 其中!#表示本行所有命令"mkdir somewhere/dir && cd”，:1取第一个参数就是目录名
```

* 操作符，在可选的参数部分之后，用一个或多个 : 操作符加特定字符。

> h 去除最后的一个文件路径部分，假设上一条命令echo /tmp/123/456/，则cd !:1:h:h意为cd /tmp/123；假设上一条命令echo /tmp/123/456，则cd !:1:h:h意为cd /tmp  
> t 去除所有的开始的文件路径部分，假设上一条命令为echo /tmp/123/456/，则cd !:1:t意为cd；假设上一条命令为echo /tmp/123/456，则cd !:1:t意为cd 456  
> r 去除后缀，假设上一条命令为echo /tmp/bbs.c，则echo !:1:r意为echo /tmp/bbs  
> e 得到后缀，假设上一条命令为echo /tmp/bbs.c，则echo !:1:e意为echo .c  
> p print命令而不执行  
> [g]s/string1/sting2/ 将命令的string1替换为string2，g意为全局替换，假设上一条命令为echo 1 2 1，则!:gs/1/3/意为echo 3 2 3。3.1中的^string1^string2^相当于!!:s/string1/string2/  
> [g]& 意为执行上次替换，g意为全局替换。接上例，假设上一条命令为echo 123451，则!:&意为echo 323451  
